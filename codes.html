<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">

    <title>Codes | Peter Jonathan </title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
<meta http-equiv="cache-control" content="no-cache" />

    <!-- Custom styles for this template -->
    <link href="assets/css/main.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="assets/js/hover.zoom.js"></script>
    <script src="assets/js/hover.zoom.conf.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
	
	
	
	<meta http-equiv=“Pragma” content=”no-cache”>
<meta http-equiv=“Expires” content=”-1″>
<meta http-equiv=“CACHE-CONTROL” content=”NO-CACHE”>

<script>
#toc_container {
    background: #f9f9f9 none repeat scroll 0 0;
    border: 1px solid #aaa;
    display: table;
    font-size: 95%;
    margin-bottom: 1em;
    padding: 20px;
    width: auto;
}

.toc_title {
    font-weight: 700;
    text-align: center;
}

#toc_container li, #toc_container ul, #toc_container ul li{
    list-style: outside none none !important;
}
</script>


	
	
  </head>

  <body>

    <!-- Static navbar -->
    <div class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">PETER JONATHAN</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="index.html">Home</a></li>
            <li><a href="work.html">Work</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="under_construction.html">Blog</a></li>
            <li><a href="contact.html">Contact</a></li>
			<li><a href="#" target="_blank">Resume</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
	
	
	<!-- +++++ Contact Section +++++ -->
	
	<div class="container pt">
		<div class="row mt">
			<div class="col-lg-6 col-lg-offset-3 left">
				<h3>Codes</h3>
				
				
				
			<div id="toc_container">
<p class="toc_title">Table of Contents</p>
<ul class="toc_list">
  <li><a href="#Sending_Emails_from_Google_Sheets">Sending Emails from Google Sheets</a></li>
<li><a href="#Create_new_comp_in_AE_with_Adobe_ExtendScript_Toolkit">Create new comp in AE with Adobe ExtendScript Toolkit</a></li>
<li><a href="#Import_folder_into_After_Effects_using_ExtendScript">Import folder into After Effects using ExtendScript</a></li>
<li><a href="#Add_Comp_to_Render_Queue_in_After_Effects_using_ExtendScrip">Add Comp to Render Queue in After Effects using ExtendScrip</a></li>
<li><a href="#Trimming_Footage_in_Layer_using_ExtendScript">Trimming Footage in Layer using ExtendScript</a></li>
<li><a href="#Import_files_and_create_comp_using_ExtendScript">Import files and create comp using ExtendScript</a></li>
<li><a href="#tiktok_comp">Create TikTok Comp in AE using ExtendScript</a></li>
<li><a href="#SRT_subtitle_import_for_AE">SRT subtitle import for AE</a></li>
<li><a href="#PowerShell_replace_rename">Removing the same part of a file name for many files in Windows - PowerShell</a></li>




</ul>
</div>	
				
				<p> </p>
				<p> </p>
				
				<h4 id="Sending_Emails_from_Google_Sheets">Sending Emails from Google Sheets</h4>
<pre><code>
function sendEmails() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet();  
  var url = ss.getUrl();
  var email = Session.getActiveUser().getEmail();
  var docname = ss.getName(); 
  var sheetname = sheet.getName();     
  var mycell = ss.getActiveSelection();
  var cellcol = mycell.getColumn();
  var cellrow = mycell.getRow();
  var dataRange = sheet.getRange(cellrow, 1, 1, 16);
  var data = dataRange.getValues();
  for (i in data) {
    var column = data[i];
    var emailSendTo = "your.email@provider.com";        
    var message = "Position: " + sheetname + "\n\n"
    + "Applicant Name: " + column[2] + "\n\n"
    + "Status: " + column[0] + "\n\n" 
    + "Updated by: " + email  + "\n\n"    
    + "To view the complete changes visit: " + url;  
    var subject = sheetname + " Candidate Status Update";     
    if (cellcol == 1)
    {       
    MailApp.sendEmail(emailSendTo, subject, message);
    }
  }
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Google Apps Script</a></bt> - <bt><a href="#">JavaScript</a></bt></p>

	
	
	
	
	
	<h4 id="Create_new_comp_in_AE_with_Adobe_ExtendScript_Toolkit">Create new comp in AE with Adobe ExtendScript Toolkit</h4>
<pre><code>
{
  app.beginUndoGroup("Demo Script");

  // Creating project
  var currentProject  = (app.project) ? app.project : app.newProject();

  // Creating comp
  var compSettings    = cs = [1280, 720, 1, 10, 24];
  var defaultCompName = "Demo"
  var currentComp     = (currentProject.activeItem) ? currentProject.activeItem : currentProject.items.addComp(defaultCompName, cs[0], cs[1], cs[2], cs[3], cs[4]);
  currentComp.openInViewer();

  // Creating background layer
  var backgroundLayer = currentComp.layers.addSolid([93, 5, 2], "Background", cs[0], cs[1], cs[2]);

  app.endUndoGroup();
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>





<h4 id="Import_folder_into_After_Effects_using_ExtendScript">Import folder into After Effects using ExtendScript</h4>
<pre><code>
var folder = new Folder;
folder = folder.selectDlg("Please select a folder");

if(folder.exists) {
    var files = folder.getFiles();
    importFiles(files, folder.name.replace(/%20/g, " "));
}

function importFiles(files, folderName) {
    app.beginSuppressDialogs();
    // additionally you can create the folder in AE to put all your imported files into
    var folder = app.project.items.addFolder(folderName);
    var imported;
        for(var i = 0; i < files.length; i++) {
            // only import it if its not a folder
            if(files[i].name.indexOf(".") != -1) {
            imported = app.project.importFile(new ImportOptions(files[i]));
            imported.parentFolder = folder;
            }
            }
    app.endSuppressDialogs(false);
    }
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>





<h4 id="Add_Comp_to_Render_Queue_in_After_Effects_using_ExtendScrip">Add Comp to Render Queue in After Effects using ExtendScript</h4>
<pre><code>
{
	var QTtemplate = "Alpha Only";
	var activeItem = app.project.activeItem;
	
	if (activeItem != null && activeItem instanceof CompItem) {
		
		var theRender = app.project.renderQueue.items.add(activeItem);
		
		if (activeItem.height < 32) {	
			theRender.outputModules[1].applyTemplate(QTtemplate);
		}
		
	} else {
		alert("Select the comp you want to render first");
	}
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>











<h4 id="Trimming_Footage_in_Layer_using_ExtendScript">Trimming Footage in Layer using ExtendScript</h4>
<pre><code>
// Layer 01
var activeItem = app.project.activeItem;
activeItem.layer(1).inPoint = 1;
activeItem.layer(1).outPoint = 2;
activeItem.layer(1).startTime = -activeItem.layer(1).inPoint;
activeItem.layer(1).scale.setValue([50, 50])


// Layer 02
var activeItem = app.project.activeItem;
activeItem.layer(2).inPoint = 3;
activeItem.layer(2).outPoint = 4;
activeItem.layer(2).startTime = -activeItem.layer(2).inPoint;
activeItem.layer(2).scale.setValue([50, 50])

// Layer 03
var activeItem = app.project.activeItem;
activeItem.layer(3).inPoint = 5;
activeItem.layer(3).outPoint = 6;
activeItem.layer(3).startTime = -activeItem.layer(3).inPoint;
activeItem.layer(3).scale.setValue([50, 50])

// Layer 04
var activeItem = app.project.activeItem;
activeItem.layer(4).inPoint = 7;
activeItem.layer(4).outPoint = 8;
activeItem.layer(4).startTime = -activeItem.layer(4).inPoint;
activeItem.layer(4).scale.setValue([50, 50])

// Layer 05
var activeItem = app.project.activeItem;
activeItem.layer(5).inPoint = 9;
activeItem.layer(5).outPoint = 10;
activeItem.layer(5).startTime = -activeItem.layer(5).inPoint;
activeItem.layer(5).scale.setValue([50, 50])

</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>
	<p>Download: <a href="assets/download/Time_Code_Tools_-_Peter.xlsm">Time Code Tools.xlsm</a></p>







<h4 id="Import_files_and_create_comp_using_ExtendScript">Import files and create comp using ExtendScript</h4>
<pre><code>

app.beginUndoGroup("Import");
 
var myFolder = new Folder("~\\Desktop\\test");
var myImportOptions = new ImportOptions();
var importedLayers = new Array();
 
var myFiles = myFolder.getFiles("*.mp4");
var myAudioFiles = myFolder.getFiles("*.mp3");
var allMyFiles = myFiles.concat(myAudioFiles);
 
var numFiles = allMyFiles.length;
var numAudio = 0;
var numVisual = 0;
var audioArray = new Array();
var visualArray = new Array();
for(var i = 0; i < allMyFiles.length; i++){
        myImportOptions.file = allMyFiles[i];
        importedLayers.push(app.project.importFile(myImportOptions));
    }
 
var duration = 0;
for(var e = 1; e <= app.project.numItems; e++){
        if(app.project.item(e).hasVideo == true){
                numVisual++;
                visualArray.push(app.project.item(e));
                duration += app.project.item(e).duration;
            }
        if(app.project.item(e).hasVideo == false && app.project.item(e).hasAudio == true){
                numAudio++;
                audioArray.push(app.project.item(e));
            }
    }
 
var tempComp = app.project.items.addComp("This is a test comp", 1280, 720, 1, 10, 24);   
tempComp.openInViewer();
var startTime = 0;
for(var q = 0; q < visualArray.length; q++){
        
        var thisLayer = tempComp.layers.add(visualArray[q]);
        thisLayer.audioEnabled = false;
        thisLayer.startTime = startTime;
        startTime = thisLayer.outPoint;
    }
var audioLayer = tempComp.layers.add(audioArray[0]);
audioLayer.outPoint = duration;

alert("Comp created")


</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>
	
	
	
	
	
	<h4 id="tiktok_comp">Create TikTok Comp in AE using ExtendScript</h4>
<pre><code>
 // create a new FolderItem in project, with name "comps"
var compFolder = app.project.items.addFolder("00. Comps");
var compFolder = app.project.items.addFolder("01. Audio");
var compFolder = app.project.items.addFolder("02. Video");
var compFolder = app.project.items.addFolder("03. Photo");
var compFolder = app.project.items.addFolder("04. ai");
var compFolder = app.project.items.addFolder("05. psd");
// move all compositions into new folder by setting
// compItem’s parentFolder to "comps" folder
for(var i = 1; i <= app.project.numItems; i++) { if(app.project.item(i) instanceof CompItem) app.project.item(i).parentFolder = compFolder; }
 
 
 
 // Creating project
{
  app.beginUndoGroup("Video TikTok");

  // Creating project
  var currentProject  = (app.project) ? app.project : app.newProject();

  // Creating comp
  var compSettings    = cs = [1080, 1920, 1, 89, 30];
  var defaultCompName = "Video TikTok"
  var currentComp     = (currentProject.activeItem) ? currentProject.activeItem : currentProject.items.addComp(defaultCompName, cs[0], cs[1], cs[2], cs[3], cs[4]);
  currentComp.openInViewer();


}


 // Import files

app.beginUndoGroup("Import");
 
var myFolder = new Folder("~\\Desktop\\media");
var myImportOptions = new ImportOptions();
var importedLayers = new Array();
 
var myFiles = myFolder.getFiles("*.jpg");
var myAudioFiles = myFolder.getFiles("*.mp3");
var myAudioFiles = myFolder.getFiles("*.aif");
var allMyFiles = myFiles.concat(myAudioFiles);
 
var numFiles = allMyFiles.length;
var numAudio = 0;
var numVisual = 0;
var audioArray = new Array();
var visualArray = new Array();
for(var i = 0; i < allMyFiles.length; i++){
        myImportOptions.file = allMyFiles[i];
        importedLayers.push(app.project.importFile(myImportOptions));
    }




//Extra Folders


{

function FolderSetup(thisObj)
{
var folderSetupData = new Object();
folderSetupData.scriptName = "New Folder Setup";
folderSetupData.version = "1.2";

folderSetupData.strAboutTitle = "About " + folderSetupData.scriptName;
folderSetupData.strAbout = folderSetupData.scriptName + " " + folderSetupData.version + "\n" +

"This script allows you to describe a hierarchy of folders to create in the Project panel by entering folder names on successive lines, with the indentation implying the nesting level.\n" +
"\n" +
"To enter new lines, press Ctrl+Enter (Windows) or Ctrl+Return (Mac) in CS5.5 and earlier, or just Enter/Return in CS6 and later. Use four (4) additional spaces of indentation at the beginning of a line to indicate that you want a folder to be created inside the previous parent folder.\n" +
"\n" +
"You can use this script as a dockable panel by placing it in a ScriptUI Panels subfolder of the Scripts folder, and then choosing the Folder Setup.jsx script from the Window menu.";
folderSetupData.strFolderHierarchy = "Ai nevoie de alte foldere? Adauga folderele mai jos, unul sub altul";
folderSetupData.strDefaultHierarchy = "New folder 1 / New folder 2";
folderSetupData.strCreateFolders = "Creaza folder";
folderSetupData.strHelp = "?";
folderSetupData.strErrMinAE90 = "This script requires Adobe After Effects CS4 or later.";

// folderSetup_buildUI()
// Function for creating the user interface
function folderSetup_buildUI(thisObj)
{
var pal = (thisObj instanceof Panel) ? thisObj : new Window("palette", folderSetupData.scriptName, undefined, {resizeable: true});

if (pal != null)
{
var hierarchyWantReturn = (parseFloat(app.version) >= 11) ? ", wantReturn: true" : "";
var res =
"""group {
orientation:'column', alignment:['fill','fill'],
header: Group {
alignment:['fill','top'],
hierarchyTitle: StaticText { text:'""" + folderSetupData.strFolderHierarchy + """', alignment:['fill','bottom'] },
helpBtn: Button { text:'""" + folderSetupData.strHelp + """', alignment:['right','top'], preferredSize:[25,-1] },
},
hierarchy: EditText { properties:{multiline: true""" + hierarchyWantReturn + """}, alignment:['fill','fill'], preferredSize:[150,150] },
createBtn: Button { text:'""" + folderSetupData.strCreateFolders + """', alignment:['center','bottom'] },
}""";
pal.margins = [10,10,10,10];
pal.grp = pal.add(res);

pal.grp.header.helpBtn.onClick = function () {alert(folderSetupData.strAbout, folderSetupData.strAboutTitle);}
pal.grp.hierarchy.text = folderSetupData.strDefaultHierarchy;
pal.grp.createBtn.onClick = folderSetup_doCreateFolders;

pal.layout.layout(true);
pal.layout.resize();
pal.onResizing = pal.onResize = function () {this.layout.resize();}
}

return pal;
}

// folderSetup_doCreateFolders()
// Callback function for creating the actual folder structure
function folderSetup_doCreateFolders()
{
var folderNames = this.parent.hierarchy.text.split("\n"); // Split the lines of edittext content into an array

if (folderNames.length > 0)
{
app.beginUndoGroup(folderSetupData.scriptName);

var matches;
var currParent = lastFolder = app.project.rootFolder, newFolder;
var currIndent = 0, newIndent;

// Traverse the folder names
for (var f in folderNames)
{
// Use a regular expression to pick off the indentation and folder name
matches = folderNames[f].match(/^(\s*)(.*)$/);
if ((matches != null) && ((matches.length == 3) && (matches[2] != ""))) // Skip blank lines
{
//$.writeln("creating folder named '"+matches[2]+"'");
newIndent = parseInt(matches[1].length / 4);

// Determine where to place the new folder
if (newIndent > currIndent) // Nest new folder
{
currParent = lastFolder;
currIndent++;
}
else if (newIndent < currIndent) // Create in some parent folder
{
// Find indent matching newIndent by traversing parent folders
while ((currIndent > 0) && (currIndent > newIndent))
{
currParent = currParent.parentFolder;
currIndent--;
}
}
// else create at same level as previous folder (sibling)

// Create the new folder in the current parent
lastFolder = newFolder = app.project.items.addFolder(matches[2]);
newFolder.parentFolder = currParent;
}
}

app.endUndoGroup();
}
}

// main:
//

if (parseFloat(app.version) < 9)
{
alert(folderSetupData.strErrMinAE90, folderSetupData.scriptName);
return;
}
else
{
var fsPal = folderSetup_buildUI(thisObj);
if (fsPal != null)
{
// Use the last defined folder hierarchy (saved in the After Effects preferences file), if it exists
if (app.settings.haveSetting("Adobe", "folderSetup_hierarchy"))
{
fsPal.grp.hierarchy.text = app.settings.getSetting("Adobe", "folderSetup_hierarchy").toString();
}

// Save current folder hierarchy upon closing the palette
fsPal.onClose = function()
{
app.settings.saveSetting("Adobe", "folderSetup_hierarchy", fsPal.grp.hierarchy.text);
}

if (fsPal instanceof Window)
{
fsPal.center();
fsPal.show();
}
else
fsPal.layout.layout(true);
}
}
}

FolderSetup(this);
}



//   END - Creaza foldere extra



 // START Project Management


// This script will organize your files in project panel, You can move all the specific files to their particular folders respectively, 
{
	function myScript(thisObj){
		function myScript_buildUI(thisObj){
			var myPanel = (thisObj instanceof Panel) ? thisObj : new Window("palette", "Project Management", undefined, {resizeable:true});
            var myButton = myPanel.add("button",[10,10,100,30], "Folder Structure");
            var importFile = myPanel.add("button",[10,10,100,30], "Import File");
            var movecomps = myPanel.add("button",[10,10,100,30], "Move Comps");
            var movepng = myPanel.add("button",[10,10,100,30], "Move Images");
            var moveplates = myPanel.add("button",[10,10,100,30], "Move Videos");
            var movesound = myPanel.add("button",[10,10,100,30], "Move Audio");
            var moveAi = myPanel.add("button",[10,10,100,30], "Move Vector files");
            var movepsd = myPanel.add("button",[10,10,100,30], "Move PSD files");
            var deletefolders = myPanel.add("button",[10,10,125,30], "Delete Empty Folders");
            

		    myButton.helpTip = "Create the right Directories";
			myButton.onClick = function() {
                var compFolder = false;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "00. Comps")){
      var myFolder = app.project.item(i);
      compFolder = true;
      break;
      }
  }
if(!compFolder){
    var myFolder = app.project.items.addFolder("00. Comps");
    }


// Second Folder
{
var aiFolder = false;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "04. ai")){
      var myaiFolder = app.project.item(i);
      aiFolder = true;
      break;
      }
  }
if(!aiFolder){
    var myaiFolder = app.project.items.addFolder("04. ai");
    }}

// Third Folder
{
var pngFolder = false;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "03. Photo")){
      var mypngFolder = app.project.item(i);
      pngFolder = true;
      break;
      }
  }
if(!pngFolder){
    var mypngFolder = app.project.items.addFolder("03. Photo");
    }
}


// Fourth Folder
{
var platesFolder = false;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "02. Video")){
      var myplatesFolder = app.project.item(i);
      platesFolder = true;
      break;
      }
  }
if(!platesFolder){
    var myplatesFolder = app.project.items.addFolder("02. Video");
    }
}

// Fifth Folder
{
  var soundFolder = false;
    for (var i = 1; i <= app.project.numItems; i++){
      if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "01. Audio")){
        var mysoundFolder = app.project.item(i);
        soundFolder = true;
        break;
        }
    }
  if(!soundFolder){
      var mysoundFolder = app.project.items.addFolder("01. Audio");
      }
  }
			
 // Sixth Folder
 
{
var psdFolder = false;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "05. psd")){
      var mypsdFolder = app.project.item(i);
      psdFolder = true;
      break;
      }
  }
if(!psdFolder){
    var mypsdFolder = app.project.items.addFolder("05. psd");
    }
}            


}
			
        
        importFile.helpTip = "Import Files in After Effects";
        importFile.onClick = ImportFile ;
 
function ImportFile () {
 
        app.beginUndoGroup("Import File");
 
        var targetFile = File.openDialog("Import File");
       
        if (targetFile) {
                  var importOptions = new ImportOptions (targetFile);                                                                
                  app.project.importFile (importOptions);                
                }
        app.endUndoGroup();
    }
		
movecomps.helpTip = "Move all the compositions to comp folder";			
movecomps.onClick = function(){
var compFolder = null;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "00. Comps")){
      compFolder = app.project.item(i);
      break;
    }
  }

  if (compFolder == null) return;
  var comps = [];
for(var i = 1; i <= app.project.numItems; i++){
    if(app.project.item(i) instanceof CompItem)
    comps.push(app.project.item(i));
  }
  for (var i = 0; i < comps.length; i++)
        comps[i].parentFolder = compFolder;
  
  }

// Move AI/Eps Code

moveAi.helpTip = "Move all the Illustrator files to ai folder";
moveAi.onClick = function (){
var aiFolder = null;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "04. ai")){
        
      aiFolder = app.project.item(i);
      break;
    }
  }

  if (aiFolder == null) return;
  var ai = [];
for(var i = 1; i <= app.project.numItems; i++){
    var splitName = app.project.item(i).name.split(".");
    if((app.project.item(i) instanceof FootageItem) && (splitName[splitName.length-1].toLowerCase() == "ai") || (splitName[splitName.length-1].toLowerCase() == "eps"))
    ai.push(app.project.item(i));
  }
  for (var i = 0; i < ai.length; i++)
        ai[i].parentFolder = aiFolder;
  
  }

// End Code

// Move Png Code

movepng.helpTip = "Move all the Png files to png folder";
movepng.onClick = function (){
var pngFolder = null;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "03. Photo")){
        
      pngFolder = app.project.item(i);
      break;
    }
  }

  if (pngFolder == null) return;
  var pngs = [];
for(var i = 1; i <= app.project.numItems; i++){
    var splitName = app.project.item(i).name.split(".");
    if((app.project.item(i) instanceof FootageItem) && (splitName[splitName.length-1].toLowerCase() == "png") || (splitName[splitName.length-1].toLowerCase() == "jpg") || (splitName[splitName.length-1].toLowerCase() == "exr"))
    pngs.push(app.project.item(i));
  }
  for (var i = 0; i < pngs.length; i++)
        pngs[i].parentFolder = pngFolder;
  
  }

// End Code

// Move Sound

movesound.helpTip = "Move all the Sound files to sound folder";
movesound.onClick = function (){
var soundFolder = null;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "01. Audio")){
        
      soundFolder = app.project.item(i);
      break;
    }
  }

  if (soundFolder == null) return;
  var sound = [];
for(var i = 1; i <= app.project.numItems; i++){
    var splitName = app.project.item(i).name.split(".");
    if((app.project.item(i) instanceof FootageItem) && (splitName[splitName.length-1].toLowerCase() == "wav") || (splitName[splitName.length-1].toLowerCase() == "aif") || (splitName[splitName.length-1].toLowerCase() == "mp3"))
    sound.push(app.project.item(i));
  }
  for (var i = 0; i < sound.length; i++)
        sound[i].parentFolder = soundFolder;
  
  }

// End Code

// Move Plates Code

moveplates.helpTip = "Move all the Footages to plates folder";
moveplates.onClick = function (){
var platesFolder = null;
  for (var i = 1; i <= app.project.numItems; i++){
    if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "02. Video")){
        
      platesFolder = app.project.item(i);
      break;
    }
  }

  if (platesFolder == null) return;
  var plates = [];
for(var i = 1; i <= app.project.numItems; i++){
    var splitName = app.project.item(i).name.split(".");
    if((app.project.item(i) instanceof FootageItem) && (splitName[splitName.length-1].toLowerCase() == "mov") || (splitName[splitName.length-1].toLowerCase() == "mp4") || (splitName[splitName.length-1].toLowerCase() == "avi"))
    plates.push(app.project.item(i));
}
for (var i = 0; i < plates.length; i++)
      plates[i].parentFolder = platesFolder;

}

// End Code

// Move PSD Code

movepsd.helpTip = "Move all the PSD files to psd folder";
movepsd.onClick = function (){
  var psdFolder = null;
    for (var i = 1; i <= app.project.numItems; i++){
      if ((app.project.item(i) instanceof FolderItem) && (app.project.item(i).name == "05. psd")){
        psdFolder = app.project.item(i);
        break;
      }
    }
    if (psdFolder == null) return;
      var psds = [];
      for(var i = 1; i <= app.project.numItems; i++){
        var splitName = app.project.item(i).name.split(".");
        if((app.project.item(i) instanceof FootageItem) && (splitName[splitName.length-1].toLowerCase() == "psd"))
          psds.push(app.project.item(i));
      }
      for (var i = 0; i < psds.length; i++)
        psds[i].parentFolder = psdFolder;
  }

// End Code



// Delete Empty Folders Code

deletefolders.helpTip = "Delete all empty folders";
deletefolders.onClick = function removeFolders(theFolder) {
  var del = [];
    for (var i = 1; i<=app.project.numItems; i++) {
    if(app.project.item(i) instanceof FolderItem& app.project.item(i).numItems==0)
    del.push(app.project.item(i));
  }
  for (var i = 0; i < del.length; i++)
    del[i].remove();

  

  // loop from last to first item so removing a folder won't affect the index
 // for (var i = theFolder.numItems; i > 0; i--) {
 
  //if (theFolder.item(i) instanceof FolderItem) {
  // if subfolder contains items, enter recursive function again using the subfolder
  //if (theFolder.item(i).numItems > 0) removeFolders(theFolder.item(i));
 
  // if either it never contained any items, or the contents has now been removed after leaving the later recursions, delete the folder
  //if (theFolder.item(i).numItems == 0) theFolder.item(i).remove();
  //}
  //}
}
 
// enter function for the first time using the root folder
//removeFolders(app.project);


// End Code

myPanel.layout.layout(true);			
            return myPanel;
		}
	
		
		var myScriptPal = myScript_buildUI(thisObj);

		if (myScriptPal != null && myScriptPal instanceof Window){
			myScriptPal.center();
			myScriptPal.show();
		}

	}
	myScript(this);
}






 // END Project Management



 // Alert

alert("Compozitia a fost creata cu succes. Au fost importate cu succes toate fisierele si a fost creata structura de foldere standard. Adauga fisierele importate in foldere. Creeaza-ti foldere noi.")


</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>










<h4 id="SRT_subtitle_import_for_AE">SRT subtitle import for AE</h4>
<pre><code>

/**
    SRT subtitle import for AE 
   
    Usage:
    Create a text layer in AE and select that layer.
    Select File -> Script -> Run script... from the menu and run this script.
    In the dialog, select a .SRT subtitle file to import.

 */
function makeSubs() {
    function getframe(timeInString){
    var t=timeInString.split(":");
    var timeS=parseInt(t)*3600+parseInt(t[1])*60+parseFloat(t[2].replace(",","."));
    var frame=timeS*25;
    return timeS;
    }
    var pb=progressBar("Creating keyframes",);
        var layer = app.project.activeItem.selectedLayers[0];
 
        if (layer.property("sourceText") != null) {
            var textFile = File.openDialog("Select a text file to open.", "SRT subtitles:*.srt");
            if (textFile != null) {
                var textLines = new Array();
                textFile.open("r", "TEXT", "????");
 
               
                var sourceText = layer.property("sourceText");
                var subnr=0;
                var nrSubs=0;
                while (!textFile.eof) {
                    if (""==textFile.readln())
                        nrSubs++;
                    }
                textFile.seek(0);
                //begin with empty text
                sourceText.setValueAtTime(0,"");
                while (!textFile.eof) {
                    pb.setValue(subnr/nrSubs);
//                    $.sleep(1);
                    pb.p.update();
                    if (pb.isCanceled ()){//for some reason this doesn't work at all, the window is unresponsive...
                        pb.close();
                        return;
                    }
                       
                    subnr++;
                    var line = textFile.readln();
                        line = textFile.readln();
                        var times=line.split('-->');
                        var starttime=getframe(times[0]);
                        var stoptime=getframe(times[1]);
//                        line= textFile.readln();
                        var text=""
                        while ((line= textFile.readln())!=""){
                            text+=line+"\r\n";
//                            line=textFile.readln()+"\n";
                          }
                        sourceText.setValueAtTime(starttime,text);// new TextDocument(text));
                        sourceText.setValueAtTime(stoptime,"");// new TextDocument(""));
                    }
 
                textFile.close();
                pb.close();
            }
        }
    }
 
/*
Easy to use progress bar for ExtendScript.
Written by poly@omino.com, 2007
Enjoy, but this credit must remain intact.
 
>usage:
 
> var pb = progressBar("main title","subtitle");
pb.setValue(valueFrom0to1);
pb.setTitle2("new subtitle display!")
if(pb.isCanceled())
pb.close(); // they clicked cancel
*/
function progressBar(title1)
{
    var result = new Object();
    result.running = true;
    result.p = new Window("palette");
    result.p.orientation = "column";
    result.p.alignChildren = "left";
 
    result.t1 = result.p.add("statictext",undefined,title1);
    result.b = result.p.add("progressbar");
 
    result.c = result.p.add("button",undefined,"Cancel");
    result.c.onClick = function() {
        this.running = false;
    }
 
    result.isRunning = function() { return this.running; }
    result.isCanceled = function() { return !this.isRunning(); }
    result.setValue = function(x) { this.b.value = x * 100; }
    result.setTitle1 = function(t1) { this.t1.text = t1; }
    result.close = function() { this.p.close(); }
 
    result.p.show();
    return result;
}
makeSubs();


</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>
	
	
	
	
	
	
	
	
	
	
	<h4 id="PowerShell_replace_rename">Removing the same part of a file name for many files in Windows - PowerShell</h4>
<pre><code>

cd D:\rename

---
or
---

Set-Location -Path "G:\my folder location"

---

get-childitem *.pdf | foreach { rename-item $_ $_.Name.Replace("-", " ") }
get-childitem *.pdf | foreach { rename-item $_ $_.Name.Replace("_", " ") }



---

Analyzing it:

get-childitem *.pdf
This lists all files whose names end with .pdf.  They are then piped to the next command with the | operator.

foreach { rename-item $_ $_.Name.Replace("Radiohead -", " ") }
This replaces all instances of Radiohead - with nothing, denoted by " ", effectively wiping the word from all the files in the directory.

You could also modify get-childitem *.pdf to get-childitem – that would rename all the files in the directory, not just files whose names end with .pdf.

</code></pre>
	
	<p><bt>TAGS: <a href="#">PowerShell</a></bt> - <bt><a href="#">PDF</a></bt> - <bt><a href="#">Windows</a></bt></p>









	 
	
			</div>
		</div>
		
	</div><!-- /container -->
	
	
	<!-- +++++ Footer Section +++++ -->
	
	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="col-lg-4">
					<h4>Contact</h4>
					<p>
						macris.peter@gmail.com,<br/>
						+40.769.442.309, <br/>
						Bucharest, Romania.
					</p>
				</div><!-- /col-lg-4 -->
				
				<div class="col-lg-4">
					<h4>My Links</h4>
					<p>
						<a href="https://twitter.com/petermac047" target="_blank">Twitter</a><br/>
						<a href="https://www.freelancer.com/u/PeterMacris" target="_blank">Freelancer</a><br/>
						<a href="https://www.upwork.com/o/profiles/users/_~01d7b08b22d56b8099/" target="_blank">Upwork</a>
					</p>
				</div><!-- /col-lg-4 -->
				
				<div class="col-lg-4">
					<h4>About Peter</h4>
					<p>An enthusiastic freelancer, with up to 10 years experience in video/photo services.</p>
				</div><!-- /col-lg-4 -->
			
			</div>
		
		</div>
	</div>
	

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="assets/js/bootstrap.min.js"></script>
  </body>
</html>
