<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">

    <title>Codes | Peter Jonathan </title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
<meta http-equiv="cache-control" content="no-cache" />

    <!-- Custom styles for this template -->
    <link href="assets/css/main.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="assets/js/hover.zoom.js"></script>
    <script src="assets/js/hover.zoom.conf.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
	
	
	
	<meta http-equiv=“Pragma” content=”no-cache”>
<meta http-equiv=“Expires” content=”-1″>
<meta http-equiv=“CACHE-CONTROL” content=”NO-CACHE”>

<script>
#toc_container {
    background: #f9f9f9 none repeat scroll 0 0;
    border: 1px solid #aaa;
    display: table;
    font-size: 95%;
    margin-bottom: 1em;
    padding: 20px;
    width: auto;
}

.toc_title {
    font-weight: 700;
    text-align: center;
}

#toc_container li, #toc_container ul, #toc_container ul li{
    list-style: outside none none !important;
}
</script>


	
	
  </head>

  <body>

    <!-- Static navbar -->
    <div class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">PETER JONATHAN</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="index.html">Home</a></li>
            <li><a href="work.html">Work</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="under_construction.html">Blog</a></li>
            <li><a href="contact.html">Contact</a></li>
			<li><a href="#" target="_blank">Resume</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
	
	
	<!-- +++++ Contact Section +++++ -->
	
	<div class="container pt">
		<div class="row mt">
			<div class="col-lg-6 col-lg-offset-3 left">
				<h3>Codes</h3>
				
				
				
			<div id="toc_container">
<p class="toc_title">Table of Contents</p>
<ul class="toc_list">
  <li><a href="#Sending_Emails_from_Google_Sheets">Sending Emails from Google Sheets</a></li>
<li><a href="#Create_new_comp_in_AE_with_Adobe_ExtendScript_Toolkit">Create new comp in AE with Adobe ExtendScript Toolkit</a></li>
<li><a href="#Import_folder_into_After_Effects_using_ExtendScript">Import folder into After Effects using ExtendScript</a></li>
<li><a href="#Add_Comp_to_Render_Queue_in_After_Effects_using_ExtendScrip">Add Comp to Render Queue in After Effects using ExtendScrip</a></li>
<li><a href="#Trimming_Footage_in_Layer_using_ExtendScript">Trimming Footage in Layer using ExtendScript</a></li>
<li><a href="#Import_files_and_create_comp_using_ExtendScript">Import files and create comp using ExtendScript</a></li>

</ul>
</div>	
				
				<p> </p>
				<p> </p>
				
				<h4 id="Sending_Emails_from_Google_Sheets">Sending Emails from Google Sheets</h4>
<pre><code>
function sendEmails() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet();  
  var url = ss.getUrl();
  var email = Session.getActiveUser().getEmail();
  var docname = ss.getName(); 
  var sheetname = sheet.getName();     
  var mycell = ss.getActiveSelection();
  var cellcol = mycell.getColumn();
  var cellrow = mycell.getRow();
  var dataRange = sheet.getRange(cellrow, 1, 1, 16);
  var data = dataRange.getValues();
  for (i in data) {
    var column = data[i];
    var emailSendTo = "your.email@provider.com";        
    var message = "Position: " + sheetname + "\n\n"
    + "Applicant Name: " + column[2] + "\n\n"
    + "Status: " + column[0] + "\n\n" 
    + "Updated by: " + email  + "\n\n"    
    + "To view the complete changes visit: " + url;  
    var subject = sheetname + " Candidate Status Update";     
    if (cellcol == 1)
    {       
    MailApp.sendEmail(emailSendTo, subject, message);
    }
  }
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Google Apps Script</a></bt> - <bt><a href="#">JavaScript</a></bt></p>

	
	
	
	
	
	<h4 id="Create_new_comp_in_AE_with_Adobe_ExtendScript_Toolkit">Create new comp in AE with Adobe ExtendScript Toolkit</h4>
<pre><code>
{
  app.beginUndoGroup("Demo Script");

  // Creating project
  var currentProject  = (app.project) ? app.project : app.newProject();

  // Creating comp
  var compSettings    = cs = [1280, 720, 1, 10, 24];
  var defaultCompName = "Demo"
  var currentComp     = (currentProject.activeItem) ? currentProject.activeItem : currentProject.items.addComp(defaultCompName, cs[0], cs[1], cs[2], cs[3], cs[4]);
  currentComp.openInViewer();

  // Creating background layer
  var backgroundLayer = currentComp.layers.addSolid([93, 5, 2], "Background", cs[0], cs[1], cs[2]);

  app.endUndoGroup();
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>





<h4 id="Import_folder_into_After_Effects_using_ExtendScript">Import folder into After Effects using ExtendScript</h4>
<pre><code>
var folder = new Folder;
folder = folder.selectDlg("Please select a folder");

if(folder.exists) {
    var files = folder.getFiles();
    importFiles(files, folder.name.replace(/%20/g, " "));
}

function importFiles(files, folderName) {
    app.beginSuppressDialogs();
    // additionally you can create the folder in AE to put all your imported files into
    var folder = app.project.items.addFolder(folderName);
    var imported;
        for(var i = 0; i < files.length; i++) {
            // only import it if its not a folder
            if(files[i].name.indexOf(".") != -1) {
            imported = app.project.importFile(new ImportOptions(files[i]));
            imported.parentFolder = folder;
            }
            }
    app.endSuppressDialogs(false);
    }
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>





<h4 id="Add_Comp_to_Render_Queue_in_After_Effects_using_ExtendScrip">Add Comp to Render Queue in After Effects using ExtendScript</h4>
<pre><code>
{
	var QTtemplate = "Alpha Only";
	var activeItem = app.project.activeItem;
	
	if (activeItem != null && activeItem instanceof CompItem) {
		
		var theRender = app.project.renderQueue.items.add(activeItem);
		
		if (activeItem.height < 32) {	
			theRender.outputModules[1].applyTemplate(QTtemplate);
		}
		
	} else {
		alert("Select the comp you want to render first");
	}
}
</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>











<h4 id="Trimming_Footage_in_Layer_using_ExtendScript">Trimming Footage in Layer using ExtendScript</h4>
<pre><code>
// Layer 01
var activeItem = app.project.activeItem;
activeItem.layer(1).inPoint = 1;
activeItem.layer(1).outPoint = 2;
activeItem.layer(1).startTime = -activeItem.layer(1).inPoint;
activeItem.layer(1).scale.setValue([50, 50])


// Layer 02
var activeItem = app.project.activeItem;
activeItem.layer(2).inPoint = 3;
activeItem.layer(2).outPoint = 4;
activeItem.layer(2).startTime = -activeItem.layer(2).inPoint;
activeItem.layer(2).scale.setValue([50, 50])

// Layer 03
var activeItem = app.project.activeItem;
activeItem.layer(3).inPoint = 5;
activeItem.layer(3).outPoint = 6;
activeItem.layer(3).startTime = -activeItem.layer(3).inPoint;
activeItem.layer(3).scale.setValue([50, 50])

// Layer 04
var activeItem = app.project.activeItem;
activeItem.layer(4).inPoint = 7;
activeItem.layer(4).outPoint = 8;
activeItem.layer(4).startTime = -activeItem.layer(4).inPoint;
activeItem.layer(4).scale.setValue([50, 50])

// Layer 05
var activeItem = app.project.activeItem;
activeItem.layer(5).inPoint = 9;
activeItem.layer(5).outPoint = 10;
activeItem.layer(5).startTime = -activeItem.layer(5).inPoint;
activeItem.layer(5).scale.setValue([50, 50])

</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>







<h4 id="Import_files_and_create_comp_using_ExtendScript">Import files and create comp using ExtendScript</h4>
<pre><code>

app.beginUndoGroup("Import");
 
var myFolder = new Folder("~\\Desktop\\test");
var myImportOptions = new ImportOptions();
var importedLayers = new Array();
 
var myFiles = myFolder.getFiles("*.mp4");
var myAudioFiles = myFolder.getFiles("*.mp3");
var allMyFiles = myFiles.concat(myAudioFiles);
 
var numFiles = allMyFiles.length;
var numAudio = 0;
var numVisual = 0;
var audioArray = new Array();
var visualArray = new Array();
for(var i = 0; i < allMyFiles.length; i++){
        myImportOptions.file = allMyFiles[i];
        importedLayers.push(app.project.importFile(myImportOptions));
    }
 
var duration = 0;
for(var e = 1; e <= app.project.numItems; e++){
        if(app.project.item(e).hasVideo == true){
                numVisual++;
                visualArray.push(app.project.item(e));
                duration += app.project.item(e).duration;
            }
        if(app.project.item(e).hasVideo == false && app.project.item(e).hasAudio == true){
                numAudio++;
                audioArray.push(app.project.item(e));
            }
    }
 
var tempComp = app.project.items.addComp("This is a test comp", 1280, 720, 1, 10, 24);   
tempComp.openInViewer();
var startTime = 0;
for(var q = 0; q < visualArray.length; q++){
        
        var thisLayer = tempComp.layers.add(visualArray[q]);
        thisLayer.audioEnabled = false;
        thisLayer.startTime = startTime;
        startTime = thisLayer.outPoint;
    }
var audioLayer = tempComp.layers.add(audioArray[0]);
audioLayer.outPoint = duration;

alert("Comp created")


</code></pre>
	
	<p><bt>TAGS: <a href="#">Adobe ExtendScript Toolkit</a></bt> - <bt><a href="#">JavaScript</a></bt> - <bt><a href="#">ActionScript</a></bt></p>








	
	
			</div>
		</div>
		
	</div><!-- /container -->
	
	
	<!-- +++++ Footer Section +++++ -->
	
	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="col-lg-4">
					<h4>Contact</h4>
					<p>
						macris.peter@gmail.com,<br/>
						+40.769.442.309, <br/>
						Bucharest, Romania.
					</p>
				</div><!-- /col-lg-4 -->
				
				<div class="col-lg-4">
					<h4>My Links</h4>
					<p>
						<a href="https://twitter.com/petermac047" target="_blank">Twitter</a><br/>
						<a href="https://www.freelancer.com/u/PeterMacris" target="_blank">Freelancer</a><br/>
						<a href="https://www.upwork.com/o/profiles/users/_~01d7b08b22d56b8099/" target="_blank">Upwork</a>
					</p>
				</div><!-- /col-lg-4 -->
				
				<div class="col-lg-4">
					<h4>About Peter</h4>
					<p>An enthusiastic freelancer, with up to 10 years experience in video/photo services.</p>
				</div><!-- /col-lg-4 -->
			
			</div>
		
		</div>
	</div>
	

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="assets/js/bootstrap.min.js"></script>
  </body>
</html>
